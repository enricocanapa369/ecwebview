<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Parking Lot Viewer</title>
    <style>
      html, body {
        margin: 0;
        padding: 0;
        overflow: hidden;
        height: 100%;
        background: #000;
      }
      canvas {
        display: block;
      }
      #debugConsole {
        position: absolute;
        top: 0;
        left: 0;
        padding: 8px;
        font-family: monospace;
        font-size: 12px;
        background: rgba(0, 0, 0, 0.7);
        color: lime;
        white-space: pre-wrap;
        z-index: 9999;
        max-width: 100vw;
        pointer-events: none;
      }
    </style>
  </head>
  <body>
    <div id="debugConsole">Booting scene...\n</div>

    <script type="module">
      import * as THREE from 'https://cdn.jsdelivr.net/npm/three@0.155.0/build/three.module.js';
      import { OrbitControls } from 'https://cdn.jsdelivr.net/npm/three@0.155.0/examples/jsm/controls/OrbitControls.js';

      const debug = document.getElementById("debugConsole");
      const log = (msg) => {
        debug.textContent += msg + "\n";
        console.log(msg);
      };

      try {
        log("Creating renderer...");
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);
        log("Renderer initialized.");

        log("Creating scene and camera...");
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x87ceeb); // Sky-blue
        const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(10, 10, 10);
        log("Scene and camera ready.");

        log("Adding lights...");
        const dirLight = new THREE.DirectionalLight(0xffffff, 1);
        dirLight.position.set(5, 10, 7);
        scene.add(dirLight);
        scene.add(new THREE.AmbientLight(0x404040));
        log("Lights added.");

        log("Adding orbit controls...");
        const controls = new OrbitControls(camera, renderer.domElement);
        controls.target.set(0, 0, 0);
        controls.update();
        log("Controls ready.");

        log("Creating ground...");
        const loader = new THREE.TextureLoader();
        loader.load(
          'https://i.imgur.com/9z3UueZ.jpeg',
          (texture) => {
            texture.wrapS = texture.wrapT = THREE.RepeatWrapping;
            texture.repeat.set(10, 10);

            const ground = new THREE.Mesh(
              new THREE.PlaneGeometry(100, 100),
              new THREE.MeshStandardMaterial({ map: texture })
            );
            ground.rotation.x = -Math.PI / 2;
            scene.add(ground);
            log("Ground added.");
          },
          undefined,
          (err) => {
            log("Error loading ground texture.");
          }
        );

        log("Creating car...");
        const car = new THREE.Mesh(
          new THREE.BoxGeometry(2, 1, 4),
          new THREE.MeshStandardMaterial({ color: 0xff0000 })
        );
        car.position.y = 0.5;
        scene.add(car);
        log("Car added.");

        log("Setting resize handler...");
        window.addEventListener('resize', () => {
          camera.aspect = window.innerWidth / window.innerHeight;
          camera.updateProjectionMatrix();
          renderer.setSize(window.innerWidth, window.innerHeight);
          log("Window resized.");
        });

        log("Starting animation loop...");
        function animate() {
          requestAnimationFrame(animate);
          controls.update();
          renderer.render(scene, camera);
        }
        animate();
        log("Scene boot complete.");
      } catch (err) {
        log("Fatal error: " + err.message);
      }
    </script>
  </body>
</html>